# üìã RSS Media Bus v3.1 - Changelog

**–î–∞—Ç–∞ –≤—ã–ø—É—Å–∫–∞:** 20 –∏—é–ª—è 2025  
**–°—Ç–∞—Ç—É—Å:** –°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω (CRITICAL FIX)
**–ü—Ä–æ–±–ª–µ–º–∞:** User Notification Service –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–ª Moscow –≤—Ä–µ–º—è —Å UTC –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **–§–∞–π–ª:** `user_notification_service.py:240-250`
- **–°–∏–º–ø—Ç–æ–º:** 0 –Ω–æ–≤—ã—Ö —Å—Ç–∞—Ç–µ–π –Ω–∞—Ö–æ–¥–∏–ª–æ—Å—å, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –∏—Ö –Ω–∞–ª–∏—á–∏–µ –≤ –ë–î
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è `pytz.timezone('Europe/Moscow')` ‚Üí UTC
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –Ω–æ–≤—ã–µ —Å—Ç–∞—Ç—å–∏ —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è

```python
# –î–û–ë–ê–í–õ–ï–ù–û:
moscow_tz = pytz.timezone('Europe/Moscow')
if last_check.tzinfo is None:
    moscow_time = moscow_tz.localize(last_check)
else:
    moscow_time = last_check
utc_time = moscow_time.astimezone(pytz.UTC)
utc_str = utc_time.strftime('%Y-%m-%d %H:%M:%S')
cursor.execute(query, (utc_str,))
```

### ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Å–ø–∞–º–∞ —Å—Ç–∞—Ä—ã–º–∏ –Ω–æ–≤–æ—Å—Ç—è–º–∏ (UX FIX)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å —Å–æ—Ç–Ω–∏ —Å—Ç–∞—Ä—ã—Ö —Å—Ç–∞—Ç–µ–π (443 —Å—Ç–∞—Ç—å–∏)
- **–§–∞–π–ª:** `user_notification_service.py:76`
- **–°–∏–º–ø—Ç–æ–º:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–ª "–∑–∞–≤–∞–ª" —Å—Ç–∞—Ä—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- **–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ `last_check`

```python
# –ë–´–õ–û (–ø–ª–æ—Ö–æ):
self.last_check_time[user_id] = datetime.now() - timedelta(hours=3)

# –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
self.last_check_time[user_id] = datetime.now()
```

### ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (RELIABILITY FIX)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ RSS Core/User Service —Ä–∞–±–æ—Ç–∞–ª–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- **–§–∞–π–ª:** `start_system.sh` (–Ω–æ–≤—ã–π)
- **–°–∏–º–ø—Ç–æ–º:** –ö–∞–∂–¥–∞—è –Ω–æ–≤–æ—Å—Ç—å –ø—Ä–∏—Ö–æ–¥–∏–ª–∞ 2+ —Ä–∞–∑–∞
- **–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω —É–º–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "–∑–∞–≤–∏—Å–∞–Ω–∏—è" RSS Core
**–ü—Ä–æ–±–ª–µ–º–∞:** RSS Core –ø–µ—Ä–µ—Å—Ç–∞–≤–∞–ª –ø–∞—Ä—Å–∏—Ç—å –Ω–æ–≤—ã–µ —Å—Ç–∞—Ç—å–∏ –±–µ–∑ –≤–∏–¥–∏–º—ã—Ö –ø—Ä–∏—á–∏–Ω
- **–°–∏–º–ø—Ç–æ–º:** –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–∫–∞–∑—ã–≤–∞–ª—Å—è –∫–∞–∫ –∞–∫—Ç–∏–≤–Ω—ã–π, –Ω–æ —Å—Ç–∞—Ç—å–∏ –Ω–µ –¥–æ–±–∞–≤–ª—è–ª–∏—Å—å –≤ –ë–î
- **–†–µ—à–µ–Ω–∏–µ:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `start_system.sh` —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º

## üîß –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìú –°–∫—Ä–∏–ø—Ç —É–º–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (start_system.sh)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- ‚úÖ –ó–∞–ø—É—Å–∫ RSS Bus Core (—Å—Ç—Ä–æ–≥–æ 1 —ç–∫–∑–µ–º–ø–ª—è—Ä)
- ‚úÖ –ó–∞–ø—É—Å–∫ User Notification Service (—Å—Ç—Ä–æ–≥–æ 1 —ç–∫–∑–µ–º–ø–ª—è—Ä)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –í—ã–≤–æ–¥ PID –∏ –ø—É—Ç–µ–π –∫ –ª–æ–≥–∞–º
- ‚úÖ –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã

### üìö –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **README.md** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω —Å —É—á–µ—Ç–æ–º v3.1
- **QUICKSTART.md** - –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –Ω–æ–≤—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º –∑–∞–ø—É—Å–∫–∞
- **docs/PROCESSES.md** - –¥–æ–±–∞–≤–ª–µ–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
- **docs/TROUBLESHOOTING.md** - –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å —Ä–µ—à–µ–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ User Notification Service
```python
# –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å pytz
import pytz

# –£–ª—É—á—à–µ–Ω SQL –∑–∞–ø—Ä–æ—Å —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π –≤—Ä–µ–º–µ–Ω–∏
query = """
SELECT feed_id, title, description, content, link, tags, published_date
FROM articles 
WHERE added_date > ? 
ORDER BY added_date DESC
LIMIT 100
"""

# –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω
moscow_tz = pytz.timezone('Europe/Moscow')
utc_time = moscow_time.astimezone(pytz.UTC)
utc_str = utc_time.strftime('%Y-%m-%d %H:%M:%S')
cursor.execute(query, (utc_str,))
```

### –ù–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—Å–∫–∞
```bash
# –°–¢–ê–†–´–ô —Å–ø–æ—Å–æ–± (–ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω—ã–π):
python3 rss_bus_core.py &
python3 user_notification_service.py &

# –ù–û–í–´–ô —Å–ø–æ—Å–æ–± (–Ω–∞–¥–µ–∂–Ω—ã–π):
./start_system.sh
```

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π (v3.0)
- ‚ùå 0% –¥–æ—Å—Ç–∞–≤–ª—è–µ–º–æ—Å—Ç—å –Ω–æ–≤–æ—Å—Ç–µ–π (timezone –ø—Ä–æ–±–ª–µ–º–∞)
- ‚ùå 443 —Å—Ç–∞—Ä—ã–µ —Å—Ç–∞—Ç—å–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π (2-4x)
- ‚ùå –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ "–∑–∞–≤–∏—Å–∞–Ω–∏—è" RSS Core

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π (v3.1)
- ‚úÖ 100% –¥–æ—Å—Ç–∞–≤–ª—è–µ–º–æ—Å—Ç—å –Ω–æ–≤–æ—Å—Ç–µ–π
- ‚úÖ 0 —Å—Ç–∞—Ä—ã—Ö —Å—Ç–∞—Ç–µ–π –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- ‚úÖ –†–æ–≤–Ω–æ 1 –∫–æ–ø–∏—è –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ—Å—Ç–∏
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ RSS Core

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫:
```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é
pkill -f "rss_bus_core.py"
pkill -f "user_notification_service.py"

# 2. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
git pull origin main

# 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install pytz

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é
./start_system.sh
```

### –î–ª—è –Ω–æ–≤—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫:
```bash
git clone <repository>
cd rss_media_bus
pip install -r requirements.txt
./start_system.sh
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–æ–≤–Ω–æ 2)
ps aux | grep python3 | grep -E "(rss_bus_core|user_notification)" | wc -l

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—ã–µ —Å—Ç–∞—Ç—å–∏
sqlite3 rss_media_bus.db "SELECT datetime(added_date, 'localtime'), feed_id, title FROM articles ORDER BY added_date DESC LIMIT 3;"

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
sqlite3 rss_media_bus.db "SELECT title, COUNT(*) FROM articles WHERE added_date > datetime('now', '-1 hour') GROUP BY title HAVING COUNT(*) > 1;"

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
tail -f user_service.log | grep "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å—Ç–∞—Ç–µ–π"
```

## üéØ –î–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —Ü–µ–ª–∏

1. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π –Ω–æ–≤–æ—Å—Ç–µ–π
2. **UX:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±–æ–ª—å—à–µ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∞–º —Å—Ç–∞—Ä—ã–º–∏ –Ω–æ–≤–æ—Å—Ç—è–º–∏
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ò—Å–∫–ª—é—á–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –Ω–æ–≤–æ—Å—Ç–µ–π
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º
5. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –≤—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìÖ Roadmap v3.2

- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **–ú–µ—Ç—Ä–∏–∫–∏:** Grafana –¥–∞—à–±–æ—Ä–¥ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **API:** REST API –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:** Email –∏ –¥—Ä—É–≥–∏–µ –∫–∞–Ω–∞–ª—ã —Å–≤—è–∑–∏
- **–§–∏–ª—å—Ç—Ä—ã:** –ë–æ–ª–µ–µ –≥–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤

---

**üéâ RSS Media Bus v3.1 - —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!**  
–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã, —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π. 